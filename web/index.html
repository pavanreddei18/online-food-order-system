
<!DOCTYPE html>
<html>
<head>
  <title>Online Food Ordering</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f0f4f8;
      max-width: 700px;
      margin: 30px auto;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
      color: #333;
    }
    h2 {
      color: #2c3e50;
      border-bottom: 2px solid #3498db;
      padding-bottom: 6px;
      margin-bottom: 15px;
    }
    input, button {
      width: 100%;
      padding: 12px;
      margin: 8px 0;
      border: 1.5px solid #ccc;
      border-radius: 6px;
      font-size: 1rem;
      transition: border-color 0.3s ease;
    }
    input:focus {
      border-color: #3498db;
      outline: none;
    }
    button {
      background-color: #3498db;
      color: white;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: background-color 0.3s ease;
    }
    button:hover {
      background-color: #2980b9;
    }
    #regMsg, #loginMsg {
      font-weight: 600;
      margin-top: 5px;
      min-height: 22px;
    }
    #regMsg.success, #loginMsg.success {
      color: #27ae60;
    }
    #regMsg.error, #loginMsg.error {
      color: #e74c3c;
    }
    #menuSection {
      margin-top: 30px;
    }
    .menu-item {
      background: white;
      border-radius: 8px;
      padding: 15px 20px;
      margin-bottom: 15px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.05);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .menu-item-info {
      max-width: 70%;
    }
    .menu-item-info strong {
      font-size: 1.2rem;
      color: #34495e;
    }
    .menu-item-info p {
      margin: 6px 0 0 0;
      color: #7f8c8d;
    }
    .menu-item-price {
      font-weight: 700;
      color: #2980b9;
      margin-bottom: 8px;
    }
    .menu-item button {
      padding: 10px 20px;
      border-radius: 6px;
      font-weight: 600;
      background-color: #27ae60;
      border: none;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .menu-item button:hover {
      background-color: #1e8449;
    }
  </style>
</head>
<body>

  <h2>Register</h2>
  <input id="regName" placeholder="Name" />
  <input id="regEmail" placeholder="Email" type="email" />
  <input id="regPass" placeholder="Password" type="password" />
  <button onclick="register()">Register</button>
  <p id="regMsg"></p>

  <h2>Login</h2>
  <input id="loginEmail" placeholder="Email" type="email" />
  <input id="loginPass" placeholder="Password" type="password" />
  <button onclick="login()">Login</button>
  <p id="loginMsg"></p>

  <div id="menuSection" style="display:none;">
    <h2>Menu</h2>
    <div id="menu"></div>
  </div>

  <script>
    let currentUserId = null;

    function showMessage(elementId, message, isSuccess) {
      const el = document.getElementById(elementId);
      el.textContent = message;
      el.className = isSuccess ? 'success' : 'error';
    }

    function register() {
      const name = document.getElementById('regName').value.trim();
      const email = document.getElementById('regEmail').value.trim();
      const password = document.getElementById('regPass').value.trim();
      if (!name || !email || !password) {
        showMessage('regMsg', 'Please fill all fields', false);
        return;
      }
      fetch('register', {
        method: 'POST',
        headers: {'Content-Type': 'application/x-www-form-urlencoded'},
        body: `name=${encodeURIComponent(name)}&email=${encodeURIComponent(email)}&password=${encodeURIComponent(password)}`
      })
      .then(res => res.text())
      .then(text => {
        showMessage('regMsg', text, text.toLowerCase().includes('success'));
      });
    }

    function login() {
      const email = document.getElementById('loginEmail').value.trim();
      const password = document.getElementById('loginPass').value.trim();
      if (!email || !password) {
        showMessage('loginMsg', 'Please enter email and password', false);
        return;
      }
      fetch('login', {
        method: 'POST',
        headers: {'Content-Type': 'application/x-www-form-urlencoded'},
        body: `email=${encodeURIComponent(email)}&password=${encodeURIComponent(password)}`
      })
      .then(res => res.text())
      .then(text => {
        showMessage('loginMsg', text, text.toLowerCase().includes('success'));
        if (text === 'Login successful') {
          currentUserId = 1; // Demo only
          loadMenu();
          document.getElementById('menuSection').style.display = 'block';
        } else {
          currentUserId = null;
          document.getElementById('menuSection').style.display = 'none';
        }
      });
    }

    function loadMenu() {
      fetch('menu')
        .then(res => res.json())
        .then(data => {
          const menuDiv = document.getElementById('menu');
          menuDiv.innerHTML = '';
          data.forEach(item => {
            const div = document.createElement('div');
            div.className = 'menu-item';
            div.innerHTML = `
              <div class="menu-item-info">
                <strong>${item.item_name}</strong>
                <p>${item.description}</p>
                <div class="menu-item-price">$${item.price.toFixed(2)}</div>
              </div>
              <button onclick="placeOrder(${item.id})">Order</button>
            `;
            menuDiv.appendChild(div);
          });
        });
    }

    function placeOrder(itemId) {
      if (!currentUserId) {
        alert('Please login first');
        return;
      }
      fetch('order', {
        method: 'POST',
        headers: {'Content-Type': 'application/x-www-form-urlencoded'},
        body: `user_id=${currentUserId}&item_id=${itemId}`
      })
      .then(res => res.text())
      .then(text => alert(text));
    }
  </script>

</body>
</html>
